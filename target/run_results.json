{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-19T14:29:08.623329Z", "invocation_id": "c6d2f264-81be-41a8-b2d3-8d144d5de407", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.257506Z", "completed_at": "2024-07-19T14:29:08.258876Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.273479Z", "completed_at": "2024-07-19T14:29:08.314453Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0608980655670166, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dewees.stg_customer", "compiled": true, "compiled_code": "with source as (\n\tselect * from \"orders\".\"raw\".\"customer\"\n),\nrenamed as (\n\tselect \n\t\tid as customer_id,\n\t\tfirst_name,\n\t\tlast_name,\n\t\tcustomer_since_date,\n\t\tprimary_phone,\n\t\tprimary_email\n\tfrom source\n)\nselect * \nfrom renamed", "relation_name": "\"orders\".\"staging\".\"stg_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.254308Z", "completed_at": "2024-07-19T14:29:08.258726Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.259015Z", "completed_at": "2024-07-19T14:29:08.315614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.062354087829589844, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dewees.stg_address", "compiled": true, "compiled_code": "with source as (\n\tselect * from \"orders\".\"raw\".\"address\"\n),\nrenamed as (\n\tselect \n\t\tid as address_id,\n\t\tcustomer_id,\n\t\taddress_line_1,\n\t\taddress_line_2,\n\t\taddress_line_3,\n\t\tcity,\n\t\tstate,\n\t\tpostal_code\n\tfrom source\n)\nselect * \nfrom renamed", "relation_name": "\"orders\".\"staging\".\"stg_address\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.318050Z", "completed_at": "2024-07-19T14:29:08.320771Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.320918Z", "completed_at": "2024-07-19T14:29:08.350094Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033239126205444336, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dewees.stg_holiday", "compiled": true, "compiled_code": "with source as (\n\tselect * from \"orders\".\"raw\".\"holiday\"\n),\nrenamed as (\n\tselect \n\t\tdate_key,\t\t\n\t\tname,\t\n\t\tis_work_day\n\tfrom source\n)\nselect * \nfrom renamed", "relation_name": "\"orders\".\"staging\".\"stg_holiday\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.319130Z", "completed_at": "2024-07-19T14:29:08.321995Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.322157Z", "completed_at": "2024-07-19T14:29:08.350505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03295278549194336, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dewees.stg_order", "compiled": true, "compiled_code": "with source as (\n\tselect * from \"orders\".\"raw\".\"orders\"\n),\nrenamed as (\n\tselect \n\t\tid as order_id,\n\t\tcustomer_id,\t\t\n\t\tshipping_address_id,\n\t\torder_date,\n\t\tpo_number,\n\t\ttax,\n\t\ttotal\n\tfrom source\n)\nselect * \nfrom renamed", "relation_name": "\"orders\".\"staging\".\"stg_order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.353116Z", "completed_at": "2024-07-19T14:29:08.355938Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.357013Z", "completed_at": "2024-07-19T14:29:08.388343Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03644108772277832, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dewees.stg_order_product", "compiled": true, "compiled_code": "with source as (\n\tselect * from \"orders\".\"raw\".\"order_product\"\n),\nrenamed as (\n\tselect \n\t\torder_id,\n\t\tproduct_id,\n\t\tquantity,\n\t\tpurchased_price,\n\t\tsubtotal\n\tfrom source\n)\nselect * \nfrom renamed", "relation_name": "\"orders\".\"staging\".\"stg_order_product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.354071Z", "completed_at": "2024-07-19T14:29:08.355801Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.356052Z", "completed_at": "2024-07-19T14:29:08.388897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03648996353149414, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dewees.stg_product", "compiled": true, "compiled_code": "with source as (\n\tselect * from \"orders\".\"raw\".\"product\"\n),\nrenamed as (\n\tselect \n\t\tid as product_id,\n\t\tname,\n\t\tmanufacturer,\n\t\tmanufacturer_part_number,\n\t\tinternal_part_number,\n\t\tsupplier_price,\n\t\tbase_price\n\tfrom source\n)\nselect * \nfrom renamed", "relation_name": "\"orders\".\"staging\".\"stg_product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.391517Z", "completed_at": "2024-07-19T14:29:08.402838Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.402983Z", "completed_at": "2024-07-19T14:29:08.443142Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0523219108581543, "adapter_response": {"_message": "SELECT 105", "code": "SELECT", "rows_affected": 105}, "message": "SELECT 105", "failures": null, "unique_id": "model.dewees.dim_customer", "compiled": true, "compiled_code": "with customers as (\n\tselect * from \"orders\".\"staging\".\"stg_customer\"\n),\naddresses as (\n\tselect * from \"orders\".\"staging\".\"stg_address\"\n),\nfinal as (\n\tselect \n\t\tcustomers.customer_id,\n\t\taddresses.address_id,\n\t\tcustomers.first_name,\n\t\tcustomers.last_name,\n\t\tcustomers.primary_phone,\n\t\tcustomers.primary_email,\n\t\taddresses.address_line_1 as shipping_address_line1,\n\t\taddresses.address_line_2 as shipping_address_line2,\n\t\taddresses.address_line_3 as shipping_address_line3,\n\t\taddresses.city as shipping_address_city,\n\t\taddresses.state as shipping_address_state,\n\t\taddresses.postal_code as shipping_address_postal_code\n\tfrom customers\n\tleft join addresses on addresses.customer_id = customers.customer_id\n)\nselect * \nfrom final", "relation_name": "\"orders\".\"mart\".\"dim_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.444522Z", "completed_at": "2024-07-19T14:29:08.447694Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.447820Z", "completed_at": "2024-07-19T14:29:08.517374Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07331514358520508, "adapter_response": {"_message": "INSERT 0 17866", "code": "INSERT", "rows_affected": 17866}, "message": "INSERT 0 17866", "failures": null, "unique_id": "model.dewees.dim_order", "compiled": true, "compiled_code": "\nwith orders as (\n\tselect * from \"orders\".\"staging\".\"stg_order\"\n),\nop as (\n\tselect * from \"orders\".\"staging\".\"stg_order_product\"\n),\nfinal as (\n\tselect \n\t\torders.order_id,\n\t\torders.customer_id,\n\t\torders.shipping_address_id,\n\t\torders.order_date,\n\t\torders.po_number,\n\t\top.product_id,\n\t\top.quantity,\n\t\top.purchased_price,\n\t\torders.tax,\n\t\top.subtotal,\n\t\t(orders.tax * op.subtotal) + op.subtotal as line_total\n\tfrom orders\n\tleft join op on orders.order_id = op.order_id\n\t\n\t\twhere orders.order_date > (select max(order_date) from \"orders\".\"mart\".\"dim_order\")\n\t\n)\nselect * \nfrom final", "relation_name": "\"orders\".\"mart\".\"dim_order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.392657Z", "completed_at": "2024-07-19T14:29:08.431753Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.431895Z", "completed_at": "2024-07-19T14:29:08.530196Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14046597480773926, "adapter_response": {"_message": "SELECT 29418", "code": "SELECT", "rows_affected": 29418}, "message": "SELECT 29418", "failures": null, "unique_id": "model.dewees.dim_date", "compiled": true, "compiled_code": "\n\n\nWITH date_spine AS\n(\n\t\n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n     + \n    \n    p13.generated_number * power(2, 13)\n     + \n    \n    p14.generated_number * power(2, 14)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n     cross join \n    \n    p as p13\n     cross join \n    \n    p as p14\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 29418\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    to_date('01/01/1950', 'mm/dd/yyyy') + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= to_date('2030-07-18T10:29:08.394774', 'yyyy-mm-dd')\n\n)\n\nselect * from filtered\n\n\n),\nholidays as (\n\tselect * from \"orders\".\"staging\".\"stg_holiday\"\n),\nscrubbed as ( \n  SELECT\n    CAST(DATE_SPINE.DATE_DAY AS DATE) AS DATE_KEY\n    ,CAST(DATE_PART('doy',DATE_SPINE.DATE_DAY) AS INT) AS day_of_year\n    ,CAST(DATE_PART('dow',DATE_SPINE.DATE_DAY) AS INT) AS day_of_week\n    ,CAST(DATE_PART('week',DATE_SPINE.DATE_DAY) AS INT) AS week_of_year\n    ,CAST(DATE_PART('quarter',DATE_SPINE.DATE_DAY) AS INT) AS quarter\n    ,CAST(DATE_PART('month',DATE_SPINE.DATE_DAY) AS INT) AS month\n    ,CAST(DATE_PART('year',DATE_SPINE.DATE_DAY) AS INT) AS year\n  FROM date_spine\n)\nSELECT\n  scrubbed.date_key\n  ,scrubbed.day_of_year\n  ,scrubbed.day_of_week\n  ,scrubbed.week_of_year\n  ,scrubbed.quarter\n  ,scrubbed.month\n  ,scrubbed.year\n  ,case\n     when holidays.date_key is not null then true\n   else false \n   end as is_holiday\n  , holidays.name as holiday\n  , case \n      when holidays.is_work_day = false then false\n      when scrubbed.day_of_week = 0 OR scrubbed.day_of_week = 6 then false\n      else true \n   end AS is_work_day\nFROM scrubbed\nleft join holidays on holidays.date_key = scrubbed.date_key", "relation_name": "\"orders\".\"mart\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.518913Z", "completed_at": "2024-07-19T14:29:08.520154Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.520284Z", "completed_at": "2024-07-19T14:29:08.540672Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02230691909790039, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.dewees.dim_product", "compiled": true, "compiled_code": "with prod as (\n\tselect * from \"orders\".\"staging\".\"stg_product\"\n),\nfinal as (\n\tselect \n\t\tprod.product_id,\n\t\tprod.name,\n\t\tprod.supplier_price,\n\t\tprod.base_price\n\tfrom prod\n)\nselect * \nfrom final", "relation_name": "\"orders\".\"mart\".\"dim_product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.535410Z", "completed_at": "2024-07-19T14:29:08.537246Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.537385Z", "completed_at": "2024-07-19T14:29:08.563908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02910900115966797, "adapter_response": {"_message": "SELECT 1698", "code": "SELECT", "rows_affected": 1698}, "message": "SELECT 1698", "failures": null, "unique_id": "model.dewees.fct_customer_purchase_summary", "compiled": true, "compiled_code": "with orders as (\n\tselect * from \"orders\".\"mart\".\"dim_order\"\n),\ndt as (\n\tselect * from \"orders\".\"mart\".\"dim_date\"\n),\nfinal as (\n\tselect \n\t\torders.customer_id,\n\t\tdt.year,\n\t\tdt.quarter,\n\t\tdt.month,\n\t\tsum(orders.line_total)\n\tfrom orders\n\tleft join dt on orders.order_date = dt.date_key\n\tgroup by customer_id, dt.year, dt.quarter, dt.month\n)\nselect * \nfrom final", "relation_name": "\"orders\".\"mart\".\"fct_customer_purchase_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.542125Z", "completed_at": "2024-07-19T14:29:08.543946Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.544076Z", "completed_at": "2024-07-19T14:29:08.597210Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.055570125579833984, "adapter_response": {"_message": "SELECT 17897", "code": "SELECT", "rows_affected": 17897}, "message": "SELECT 17897", "failures": null, "unique_id": "model.dewees.fct_order", "compiled": true, "compiled_code": "with orders as (\n\tselect * from \"orders\".\"mart\".\"dim_order\"\n),\nproducts as (\n\tselect * from \"orders\".\"mart\".\"dim_product\"\n),\nfinal as (\n\tselect \n\t\torders.order_id,\n\t\torders.customer_id,\n\t\tproducts.product_id,\n\t\torders.shipping_address_id,\n\t\torders.order_date as date_key,\n\t\torders.subtotal,\n\t\t(1.0 - round( cast((products.base_price / orders.purchased_price) as numeric), cast(2 as smallint)) ) as discount_pct\n\tfrom orders\n\tleft join products on orders.product_id = products.product_id\n)\nselect * \nfrom final", "relation_name": "\"orders\".\"mart\".\"fct_order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-19T14:29:08.565409Z", "completed_at": "2024-07-19T14:29:08.568660Z"}, {"name": "execute", "started_at": "2024-07-19T14:29:08.568913Z", "completed_at": "2024-07-19T14:29:08.615601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05067276954650879, "adapter_response": {"_message": "SELECT 63", "code": "SELECT", "rows_affected": 63}, "message": "SELECT 63", "failures": null, "unique_id": "model.dewees.fct_product_profitability", "compiled": true, "compiled_code": "with orders as (\n\tselect * from \"orders\".\"mart\".\"dim_order\"\n),\ndt as (\n\tselect * from \"orders\".\"mart\".\"dim_date\"\n),\nprod as (\n\tselect * from \"orders\".\"mart\".\"dim_product\"\n),\nfinal as (\n\tselect \n\t\torders.product_id,\n\t\tdt.year,\n\t\tdt.quarter,\n\t\tdt.month,\n\t\tsum(orders.quantity) as volume,\n\t\tsum(prod.supplier_price * orders.quantity) as cost,\n\t\tsum(orders.subtotal) as received,\n\t\t( sum(orders.subtotal) - sum(prod.supplier_price * orders.quantity) ) as profit\n\tfrom orders\n\tleft join prod on orders.product_id = prod.product_id\n\tleft join dt on orders.order_date = dt.date_key\n\tgroup by orders.product_id, dt.year, dt.quarter, dt.month\n)\nselect * \nfrom final", "relation_name": "\"orders\".\"mart\".\"fct_product_profitability\""}], "elapsed_time": 0.4701058864593506, "args": {"cache_selected_only": false, "use_colors_file": true, "log_path": "/Users/tim/dev/dbtdemo/logs", "version_check": true, "log_format": "default", "enable_legacy_logger": false, "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "print": true, "profiles_dir": "/Users/tim/.dbt", "log_format_file": "debug", "empty": false, "show_resource_report": false, "use_colors": true, "select": [], "printer_width": 80, "vars": {}, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "project_dir": "/Users/tim/dev/dbtdemo", "indirect_selection": "eager", "defer": false, "favor_state": false, "introspect": true, "populate_cache": true, "send_anonymous_usage_stats": true, "write_json": true, "log_level": "info", "static_parser": true, "quiet": false, "invocation_command": "dbt run", "log_level_file": "debug", "exclude": [], "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "source_freshness_run_project_hooks": false, "macro_debugging": false}}